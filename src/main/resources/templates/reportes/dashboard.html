<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout :: layout(content=~{::content}, title='Dashboard de Reportes')}">
<body>
<div th:fragment="content">

    <div class="row between">
        <h2>Dashboard de reportes</h2>
        <div class="toolbar">
            <a class="btn" th:href="@{/reportes/export/csv}">Exportar CSV</a>
            <a class="btn ghost" th:href="@{/}#reportes">← Volver al inicio</a>
        </div>
    </div>

    <!-- Indicadores -->
    <div class="grid kpis">
        <div class="card">
            <h3>Inventario de animales</h3>
            <p class="summary" th:text="${reporteResumenAnimales}">0</p>
        </div>
        <div class="card">
            <h3>Balance últimos 30 días</h3>
            <p class="summary" th:text="${reporteBalance30d}">$0</p>
        </div>
        <div class="card">
            <h3>Ocupación de lotes</h3>
            <p class="summary" th:text="${reporteOcupacion}">-</p>
        </div>
    </div>

    <!-- Últimos movimientos financieros -->
    <section class="panel">
        <div class="card">
            <h3>Últimos movimientos financieros</h3>
            <table>
                <thead>
                <tr><th>Fecha</th><th>Tipo</th><th>Concepto</th><th>Monto</th></tr>
                </thead>
                <tbody>
                <tr th:each="f, i : ${finanzas}" th:if="${i.index < 8}">
                    <td th:text="${f.fecha}">2025-01-01</td>
                    <td th:text="${f.tipo}">Ingreso</td>
                    <td th:text="${f.concepto}">Venta</td>
                    <td th:text="${f.monto}">0</td>
                </tr>
                <tr th:if="${#lists.isEmpty(finanzas)}"><td colspan="4">Sin registros</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- Resumen de animales -->
    <section class="panel">
        <div class="card">
            <h3>Inventario actual de animales</h3>
            <table>
                <thead>
                <tr><th>ID</th><th>Raza</th><th>Lote</th><th>Sexo</th><th>Fecha Nac.</th></tr>
                </thead>
                <tbody>
                <tr th:each="a, i : ${animales}" th:if="${i.index < 10}">
                    <td th:text="${a.id}">1</td>
                    <td th:text="${a.raza}">Brahman</td>
                    <td th:text="${a.lote != null ? a.lote.lote : '-'}">Lote A</td>
                    <td th:text="${a.sexo}">H</td>
                    <td th:text="${a.fechaNac}">2025-01-01</td>
                </tr>
                <tr th:if="${#lists.isEmpty(animales)}"><td colspan="5">Sin registros</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- Registros de salud -->
    <section class="panel">
        <div class="card">
            <h3>Registros recientes de salud</h3>
            <table>
                <thead>
                <tr><th>Fecha</th><th>Animal</th><th>Tipo</th><th>Descripción</th><th>Dosis</th></tr>
                </thead>
                <tbody>
                <tr th:each="s, i : ${sanidades}" th:if="${i.index < 10}">
                    <td th:text="${s.fecha}">2025-02-01</td>
                    <td th:text="${s.animal != null ? s.animal.id : '-'}">3</td>
                    <td th:text="${s.tipo}">Vacunación</td>
                    <td th:text="${s.descripcion}">Carbunco</td>
                    <td th:text="${s.dosis}">5 ml</td>
                </tr>
                <tr th:if="${#lists.isEmpty(sanidades)}"><td colspan="5">Sin registros</td></tr>
                </tbody>
            </table>
        </div>
    </section>

    <!-- Resumen de lotes -->
    <section class="panel">
        <div class="card">
            <h3>Lotes activos y registros</h3>
            <table>
                <thead>
                <tr><th>ID</th><th>Lote</th><th>Entrada</th><th>Salida</th><th>Nota</th></tr>
                </thead>
                <tbody>
                <tr th:each="l : ${lotes}">
                    <td th:text="${l.id}">1</td>
                    <td th:text="${l.lote}">Potrero A</td>
                    <td th:text="${l.fecha_entrada}">2025-01-01</td>
                    <td th:text="${l.fecha_salida != null ? l.fecha_salida : '-'}">-</td>
                    <td th:text="${l.nota}">Observaciones…</td>
                </tr>
                <tr th:if="${#lists.isEmpty(lotes)}"><td colspan="5">Sin registros</td></tr>
                </tbody>
            </table>
        </div>
    </section>

</div>
</body>
</html>
